<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø±Ø§Ø¡ ğŸš€</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@900&display=swap');
        body { background: #000; color: #fff; font-family: 'Cairo', sans-serif; text-align: center; margin: 0; overflow: hidden; }
        .game-area { height: 60vh; position: relative; background: radial-gradient(circle at bottom, #111, #000); overflow: hidden; border-bottom: 3px solid #d4af37; }
        #plane { position: absolute; bottom: 20px; left: 10%; width: 100px; filter: drop-shadow(0 0 15px #d4af37); z-index: 10; transition: transform 0.1s linear; display: block; }
        .multiplier { font-size: 80px; padding-top: 40px; color: #d4af37; font-weight: 900; text-shadow: 0 0 20px rgba(212,175,55,0.5); }
        .controls { padding: 20px; background: #0a0a0a; height: 40vh; }
        .btn { background: linear-gradient(180deg, #d4af37, #8a6d3b); color: #000; padding: 18px; border-radius: 15px; font-size: 22px; font-weight: bold; border: none; cursor: pointer; width: 90%; max-width: 400px; transition: 0.2s; }
        .btn-cashout { background: linear-gradient(180deg, #27ae60, #1e8449); color: #fff; }
        #explosion { position: absolute; width: 150px; display: none; z-index: 20; transform: translate(-50%, -50%); }
        .back-home { position: absolute; top: 10px; right: 10px; color: #d4af37; text-decoration: none; border: 1px solid #d4af37; padding: 5px 10px; border-radius: 5px; z-index: 100; }
    </style>
</head>
<body>

    <audio id="soundTakeoff" src="https://www.soundjay.com/transportation/sounds/jet-pass-by-1.mp3"></audio>
    <audio id="soundExplosion" src="https://www.soundjay.com/button/sounds/button-10.mp3"></audio>
    <audio id="soundWin" src="https://www.soundjay.com/human/sounds/applause-01.mp3"></audio>

    <div class="game-area">
        <a href="index.html" class="back-home">â¬… Ø§Ù„Ù…Ù†ØµØ©</a>
        <div id="multi" class="multiplier">1.00x</div>
        <img id="plane" src="https://files.catbox.moe/5m9k90.png" alt="plane">
        <img id="explosion" src="https://i.gifer.com/696.gif">
    </div>

    <div class="controls">
        <div style="margin-bottom:10px; font-size: 22px;">ğŸ’° Ø±ØµÙŠØ¯Ùƒ: <span id="userBalance" style="color:#d4af37">0</span></div>
        <button class="btn" id="mainBtn" onclick="toggleGame()">Ø¥Ù‚Ù„Ø§Ø¹ ğŸ›«</button>
        <p style="font-size: 13px; color: #666; margin-top: 10px;">ØªÙƒÙ„ÙØ© Ø§Ù„Ø±Ø­Ù„Ø©: 100 Ù†Ù‚Ø·Ø©</p>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://user-project-6c3bb-default-rtdb.firebaseio.com/" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let pName = localStorage.getItem('pName') || "Ù„Ø§Ø¹Ø¨";
        let score = 0, multi = 1.0, isFlying = false, timer, crashPoint;

        db.ref('players_logs/' + pName).on('value', s => {
            score = s.val() ? s.val().score : 0;
            document.getElementById('userBalance').innerText = score;
        });

        function toggleGame() {
            if (!isFlying) {
                if (score < 100) return alert("Ø±ØµÙŠØ¯Ùƒ Ù„Ø§ ÙŠÙƒÙÙŠ!");
                db.ref('players_logs/' + pName).update({ score: score - 100 });
                startFlight();
            } else { cashOut(); }
        }

        function startFlight() {
            isFlying = true; multi = 1.0;
            crashPoint = (Math.random() * 4 + 1.2).toFixed(2);
            
            document.getElementById('mainBtn').innerText = "Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ğŸ’°";
            document.getElementById('mainBtn').classList.add('btn-cashout');
            document.getElementById('soundTakeoff').play();
            
            timer = setInterval(() => {
                multi += 0.02; // Ø²ÙŠØ§Ø¯Ø© Ø³Ø±Ø¹Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯
                document.getElementById('multi').innerText = multi.toFixed(2) + "x";
                
                // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø·Ø§Ø¦Ø±Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ù‚ ÙˆØ³Ø±ÙŠØ¹ Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯
                let x = (multi - 1) * 60;
                let y = (multi - 1) * 80;
                document.getElementById('plane').style.transform = `translate(${x}px, -${y}px)`;
                
                if (multi >= crashPoint) doCrash();
            }, 80); // Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«
        }

        function doCrash() {
            clearInterval(timer);
            isFlying = false;
            document.getElementById('soundExplosion').play();
            
            let plane = document.getElementById('plane');
            let rect = plane.getBoundingClientRect();
            let explosion = document.getElementById('explosion');
            
            explosion.style.display = "block";
            explosion.style.left = rect.left + (rect.width/2) + "px";
            explosion.style.top = rect.top + (rect.height/2) + "px";
            plane.style.display = "none";
            
            setTimeout(() => resetGame(), 2500);
        }

        function cashOut() {
            clearInterval(timer);
            isFlying = false;
            document.getElementById('soundWin').play();
            let win = Math.floor(100 * multi);
            db.ref('players_logs/' + pName).update({ score: score + win });
            alert("Ø±Ø¨Ø­Øª " + win + " Ù†Ù‚Ø·Ø©! ğŸ‰");
            resetGame();
        }

        function resetGame() {
            clearInterval(timer);
            isFlying = false;
            document.getElementById('mainBtn').innerText = "Ø¥Ù‚Ù„Ø§Ø¹ ğŸ›«";
            document.getElementById('mainBtn').classList.remove('btn-cashout');
            document.getElementById('multi').innerText = "1.00x";
            document.getElementById('plane').style.display = "block";
            document.getElementById('plane').style.transform = "translate(0,0)";
            document.getElementById('explosion').style.display = "none";
        }
    </script>
</body>
</html>
