<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø±Ø§Ø¡ ğŸš€</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@900&display=swap');
        body { background: #000; color: #fff; font-family: 'Cairo', sans-serif; text-align: center; margin: 0; overflow: hidden; }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø·ÙŠØ±Ø§Ù† */
        .game-area { height: 65vh; position: relative; background: radial-gradient(circle at bottom, #1a1a1a, #000); overflow: hidden; border-bottom: 3px solid #d4af37; }
        
        /* ØµÙˆØ±Ø© Ø§Ù„Ø·Ø§Ø¦Ø±Ø© - ØªØ£ÙƒØ¯ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± */
        #plane { 
            position: absolute; bottom: 50px; left: 15%; width: 120px; 
            filter: drop-shadow(0 0 15px #d4af37); z-index: 10; 
            transition: transform 0.1s linear;
        }

        .multiplier { font-size: 70px; padding-top: 50px; color: #d4af37; font-weight: 900; }
        
        .controls { padding: 20px; background: #0a0a0a; height: 35vh; }
        .btn { 
            background: linear-gradient(180deg, #d4af37, #8a6d3b); color: #000; 
            padding: 20px; border-radius: 15px; font-size: 24px; font-weight: bold; 
            border: none; cursor: pointer; width: 90%; max-width: 400px;
        }
        .btn-cashout { background: linear-gradient(180deg, #27ae60, #1e8449); color: #fff; }
        
        #explosion { position: absolute; width: 150px; display: none; z-index: 20; }
        .back-home { position: absolute; top: 10px; right: 10px; color: #d4af37; text-decoration: none; font-size: 14px; border: 1px solid #d4af37; padding: 5px 10px; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="game-area">
        <a href="index.html" class="back-home">â¬… Ø®Ø±ÙˆØ¬ Ù„Ù„Ù…Ù†ØµØ©</a>
        <div id="multi" class="multiplier">1.00x</div>
        <img id="plane" src="https://files.catbox.moe/5m9k90.png" alt="plane">
        <img id="explosion" src="https://i.gifer.com/696.gif">
    </div>

    <div class="controls">
        <div style="margin-bottom:15px; font-size: 20px;">ğŸ’° Ø±ØµÙŠØ¯Ùƒ: <span id="userBalance" style="color:#d4af37">0</span></div>
        <button class="btn" id="mainBtn" onclick="toggleGame()">Ø¥Ù‚Ù„Ø§Ø¹ ğŸ›«</button>
        <p style="font-size: 12px; color: #555; margin-top: 10px;">ØªÙƒÙ„ÙØ© Ø§Ù„Ø±Ø­Ù„Ø©: 100 Ù†Ù‚Ø·Ø©</p>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase - ØªØ£ÙƒØ¯ Ø£Ù†Ù‡Ø§ Ù†ÙØ³ Ø§Ù„ØªÙŠ ÙÙŠ index.html
        const firebaseConfig = { databaseURL: "https://user-project-6c3bb-default-rtdb.firebaseio.com/" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let pName = localStorage.getItem('pName') || "Ù„Ø§Ø¹Ø¨_Ù…Ø¬Ù‡ÙˆÙ„";
        let score = 0, multi = 1.0, isFlying = false, timer, crashPoint;

        // Ø¬Ù„Ø¨ Ø±ØµÙŠØ¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØªØ­Ø¯ÙŠØ«Ù‡
        db.ref('players_logs/' + pName).on('value', s => {
            let data = s.val();
            score = data ? data.score : 500;
            document.getElementById('userBalance').innerText = score;
        });

        function toggleGame() {
            if (!isFlying) {
                if (score < 100) return alert("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ! ØªØ­ØªØ§Ø¬ 100 Ù†Ù‚Ø·Ø©.");
                db.ref('players_logs/' + pName).update({ score: score - 100 });
                startFlight();
            } else { cashOut(); }
        }

        function startFlight() {
            isFlying = true; multi = 1.0;
            crashPoint = (Math.random() * 5 + 1.1).toFixed(2);
            document.getElementById('mainBtn').innerText = "Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ğŸ’°";
            document.getElementById('mainBtn').classList.add('btn-cashout');
            document.getElementById('plane').style.display = "block";
            document.getElementById('plane').style.opacity = 1;
            document.getElementById('explosion').style.display = "none";
            
            timer = setInterval(() => {
                multi += 0.01;
                document.getElementById('multi').innerText = multi.toFixed(2) + "x";
                // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø·Ø§Ø¦Ø±Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰ ÙˆÙ„Ù„ÙŠÙ…ÙŠÙ†
                document.getElementById('plane').style.transform = `translate(${multi*15}px, -${multi*25}px)`;
                
                if (multi >= crashPoint) doCrash();
            }, 100);
        }

        function doCrash() {
            clearInterval(timer);
            isFlying = false;
            document.getElementById('plane').style.opacity = 0;
            document.getElementById('explosion').style.display = "block";
            document.getElementById('explosion').style.left = "30%";
            document.getElementById('explosion').style.bottom = "40%";
            
            setTimeout(() => resetGame(), 2000);
        }

        function cashOut() {
            clearInterval(timer);
            isFlying = false;
            let win = Math.floor(100 * multi);
            db.ref('players_logs/' + pName).update({ score: score + win });
            alert("ÙƒÙÙˆ! Ø³Ø­Ø¨Øª " + win + " Ù†Ù‚Ø·Ø© âœ…");
            resetGame();
        }

        function resetGame() {
            clearInterval(timer);
            isFlying = false;
            document.getElementById('mainBtn').innerText = "Ø¥Ù‚Ù„Ø§Ø¹ ğŸ›«";
            document.getElementById('mainBtn').classList.remove('btn-cashout');
            document.getElementById('multi').innerText = "1.00x";
            document.getElementById('plane').style.transform = "translate(0,0)";
            document.getElementById('explosion').style.display = "none";
            document.getElementById('plane').style.opacity = 1;
        }
    </script>
</body>
</html>
