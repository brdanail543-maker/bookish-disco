<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platinum Royal | Live Platform</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --gold: #ffca28; --green: #00ff44; --red: #ff4444; --bg: #0a0a0a; }
        body { background: var(--bg); color: white; text-align: center; font-family: sans-serif; margin: 0; overflow-x: hidden; }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ù…ØªØ­Ø±Ùƒ (150 Ù„Ø§Ø¹Ø¨) */
        .live-bar { background: #111; color: var(--green); padding: 5px; font-size: 11px; white-space: nowrap; overflow: hidden; border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 2000; }
        .scrolling-text { display: inline-block; animation: scroll 40s linear infinite; }
        @keyframes scroll { from { transform: translateX(-100%); } to { transform: translateX(100%); } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: #000; padding: 15px; border-bottom: 2px solid var(--gold); }
        #balDisp { font-size: 2.8rem; color: var(--gold); font-weight: bold; font-family: monospace; }
        .sham-id { color: var(--green); font-size: 0.7rem; font-family: monospace; margin-top: 5px; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ */
        .games-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .game-card { background: #161616; border: 1px solid #333; padding: 20px; border-radius: 20px; cursor: pointer; }
        .game-card i { font-size: 40px; display: block; margin-bottom: 8px; }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ù‡Ø§Ù† */
        .bet-selector { display: flex; justify-content: center; gap: 5px; margin: 10px 0; background: #111; padding: 10px; }
        .bet-btn { background: #222; border: 1px solid var(--gold); color: white; padding: 8px; border-radius: 5px; flex: 1; cursor: pointer; }
        .bet-btn.active { background: var(--gold); color: #000; font-weight: bold; }

        /* Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø¯Ø§Ø®Ù„ÙŠØ© */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 3000; flex-direction: column; }
        .grid-25 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; width: 90%; max-width: 340px; margin: 15px auto; }
        .cell { aspect-ratio: 1/1; background: #222; border: 1px solid #444; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }

        #planeArea { height: 200px; background: #000; margin: 15px; border-radius: 10px; position: relative; border: 1px solid #333; }
        #multiplier { font-size: 3.5rem; color: var(--gold); margin-top: 50px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="live-bar">
        <div class="scrolling-text" id="liveText">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ù†Ø´Ø§Ø·Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†...</div>
    </div>

    <div class="header">
        <div id="userNameDisp" style="font-size: 0.8rem; color: #888;">ğŸ•¹ï¸ Ø§Ù„Ù„Ø§Ø¹Ø¨: Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        <div id="balDisp">0</div>
        <div class="sham-id">SHAM CASH ID: Be066ca49abcf3d1ac79a65895aecb5e</div>
    </div>

    <div id="platformUI">
        <div class="games-grid">
            <div class="game-card" onclick="openGame('mines')"><i>ğŸ’£</i><b>Ø§Ù„Ù…Ù†Ø¬Ù… (25)</b></div>
            <div class="game-card" onclick="openGame('crash')"><i>ğŸš€</i><b>Ø§Ù„Ø·ÙŠØ§Ø±Ø©</b></div>
        </div>
        <div style="background: white; padding: 10px; display: inline-block; border-radius: 10px; margin-top: 10px;">
            <div id="qrcode"></div>
        </div>
        <p style="color:var(--gold); font-size: 12px;">Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù„Ø´Ø­Ù† Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ø¨Ø± Ø´Ø§Ù… ÙƒØ§Ø´</p>
    </div>

    <div id="minesOverlay" class="overlay">
        <div style="padding:15px; background:#000; border-bottom:1px solid #333; display:flex; justify-content:space-between;">
            <span style="color:var(--gold)">Ø§Ù„Ù…Ù†Ø¬Ù… | <span class="localBal">0</span></span>
            <button onclick="closeAll()" style="color:var(--red); background:none; border:1px solid var(--red); border-radius:5px;">Ø®Ø±ÙˆØ¬</button>
        </div>
        <div class="bet-selector">
            <button class="bet-btn active" onclick="setBet(2000, this)">2K</button>
            <button class="bet-btn" onclick="setBet(5000, this)">5K</button>
            <button class="bet-btn" onclick="setBet(10000, this)">10K</button>
            <button class="bet-btn" onclick="setBet(20000, this)">20K</button>
        </div>
        <div class="grid-25" id="mineGrid"></div>
        <button onclick="initMines()" style="background:var(--gold); border:none; padding:10px; width:80%; margin:auto; border-radius:10px; font-weight:bold;">ØªØµÙÙŠØ± Ø§Ù„Ø´Ø¨ÙƒØ©</button>
    </div>

    <div id="crashOverlay" class="overlay">
        <div style="padding:15px; background:#000; border-bottom:1px solid #333; display:flex; justify-content:space-between;">
            <span style="color:var(--gold)">Ø§Ù„Ø·ÙŠØ§Ø±Ø© | <span class="localBal">0</span></span>
            <button onclick="closeAll()" style="color:var(--red); background:none; border:1px solid var(--red); border-radius:5px;">Ø®Ø±ÙˆØ¬</button>
        </div>
        <div id="planeArea">
            <div id="multiplier">1.00x</div>
            <div id="planeImg" style="position:absolute; bottom:10px; left:10%; font-size:30px;">ğŸš€</div>
        </div>
        <div class="bet-selector">
            <button class="bet-btn active" onclick="setBet(2000, this)">2K</button>
            <button class="bet-btn" onclick="setBet(5000, this)">5K</button>
            <button class="bet-btn" onclick="setBet(10000, this)">10K</button>
        </div>
        <button id="btnStart" onclick="startCrash()" style="background:var(--gold); color:black; border:none; padding:15px; width:80%; margin:auto; border-radius:10px; font-weight:bold;">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù„ÙŠÙ‚</button>
        <button id="btnCashout" onclick="cashout()" style="display:none; background:var(--green); color:black; border:none; padding:15px; width:80%; margin:auto; border-radius:10px; font-weight:bold;">ÙƒØ§Ø´ Ø¢ÙˆØª ğŸ’°</button>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://user-project-6c3bb-default-rtdb.firebaseio.com/" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let pId = localStorage.getItem('pId') || "PLT" + Math.floor(Math.random()*99999);
        let fullName = localStorage.getItem('fullName') || "Ù„Ø§Ø¹Ø¨ Ù…Ù„ÙƒÙŠ";
        let currentBalance = 0;
        let selectedBet = 2000;

        // --- ØªÙˆÙ„ÙŠØ¯ Ø­Ø±ÙƒØ© 150 Ù„Ø§Ø¹Ø¨ ---
        const names = ["Ø£Ø­Ù…Ø¯", "Ø®Ø§Ù„Ø¯", "Ù„ÙŠØ«", "ÙÙ‡Ø¯", "Ù…Ø­Ù…Ø¯", "Ø¹Ù„ÙŠ", "Ø³Ø§Ø±Ø©", "ÙŠØ²Ù†", "Ø¹Ù…Ø±", "Ø¬Ø§Ø¯", "Ø¨Ø§Ø³Ù…", "Ù†ÙˆØ±"];
        const actions = ["Ù‚Ø§Ù… Ø¨Ø¥ÙŠØ¯Ø§Ø¹", "Ù‚Ø§Ù… Ø¨Ø³Ø­Ø¨", "Ø±Ø¨Ø­ Ù‡Ø¯ÙŠØ©", "Ø±Ø¨Ø­ ÙÙŠ Ø§Ù„Ù…Ù†Ø¬Ù…", "ÙƒØ§Ø´ Ø¢ÙˆØª Ø·ÙŠØ§Ø±Ø©"];
        function generateLiveFeed() {
            let feed = "";
            for(let i=0; i<150; i++) {
                let name = names[Math.floor(Math.random()*names.length)] + " " + Math.floor(Math.random()*99);
                let action = actions[Math.floor(Math.random()*actions.length)];
                let amount = (Math.random() * 50000).toFixed(0);
                feed += ` ğŸ”¥ ${name} ${action} Ø¨Ù‚ÙŠÙ…Ø© ${amount} SYP | `;
            }
            document.getElementById('liveText').innerText = feed + feed;
        }

        function sync() {
            db.ref('players_logs/' + pId).on('value', (s) => {
                if(s.exists()){
                    currentBalance = s.val().score;
                    document.getElementById('balDisp').innerText = Number(currentBalance).toLocaleString();
                    document.querySelectorAll('.localBal').forEach(el => el.innerText = Number(currentBalance).toLocaleString());
                }
            });
        }

        function setBet(amount, btn) {
            selectedBet = amount;
            document.querySelectorAll('.bet-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function openGame(id) {
            document.getElementById('platformUI').style.display = 'none';
            document.getElementById(id + 'Overlay').style.display = 'flex';
            if(id === 'mines') initMines();
        }

        function closeAll() {
            document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none');
            document.getElementById('platformUI').style.display = 'block';
        }

        // --- Ø§Ù„Ù…Ù†Ø¬Ù… ---
        function initMines() {
            const grid = document.getElementById('mineGrid');
            grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let cell = document.createElement('div');
                cell.className = 'cell';
                cell.onclick = function() {
                    if(currentBalance < selectedBet) return alert("Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø§ ÙŠÙƒÙÙŠ!");
                    let balAfter = currentBalance - selectedBet;
                    if(Math.random() > 0.3) {
                        this.style.background = "var(--gold)"; this.innerText = "ğŸ’";
                        db.ref('players_logs/' + pId).update({ score: balAfter + (selectedBet * 1.5) });
                    } else {
                        this.style.background = "var(--red)"; this.innerText = "ğŸ’£";
                        db.ref('players_logs/' + pId).update({ score: balAfter });
                    }
                };
                grid.appendChild(cell);
            }
        }

        // --- Ø§Ù„Ø·ÙŠØ§Ø±Ø© ---
        let crashInt; let cMult = 1.0; let flying = false;
        function startCrash() {
            if(currentBalance < selectedBet) return alert("Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø§ ÙŠÙƒÙÙŠ!");
            flying = true; cMult = 1.0;
            db.ref('players_logs/' + pId).update({ score: currentBalance - selectedBet });
            document.getElementById('btnStart').style.display = 'none';
            document.getElementById('btnCashout').style.display = 'block';
            crashInt = setInterval(() => {
                cMult += 0.02;
                document.getElementById('multiplier').innerText = cMult.toFixed(2) + "x";
                if(Math.random() < 0.02) crashNow();
            }, 100);
        }
        function crashNow() { clearInterval(crashInt); flying = false; document.getElementById('multiplier').innerText = "EXPLODED!"; setTimeout(resetCrash, 2000); }
        function cashout() { if(!flying) return; clearInterval(crashInt); flying = false; db.ref('players_logs/' + pId).update({ score: currentBalance + (selectedBet * cMult) }); resetCrash(); }
        function resetCrash() { document.getElementById('btnStart').style.display = 'block'; document.getElementById('btnCashout').style.display = 'none'; }

        window.onload = () => {
            generateLiveFeed();
            sync();
            new QRCode(document.getElementById("qrcode"), { text: "Be066ca49abcf3d1ac79a65895aecb5e", width: 100, height: 100 });
            document.getElementById('userNameDisp').innerText = "ğŸ•¹ï¸ Ø§Ù„Ù„Ø§Ø¹Ø¨: " + fullName;
        };
    </script>
</body>
</html>
